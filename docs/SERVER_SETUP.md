# Настройка сервера

Этот документ описывает базовую настройку окружения для запуска Nuxt-приложения и серверной части проекта `edu.turkish`.

## Требования

- Node.js 18 или новее
- npm (или pnpm/yarn)
- MySQL 8+ или Docker с Docker Compose

## 1. Клонирование и установка зависимостей

```bash
git clone <repository-url>
cd edu.turkish
npm install
```

## 2. Переменные окружения

1. Скопируйте шаблон файла окружения:

   ```bash
   cp .env.example .env
   ```

2. Заполните значения в `.env`:
   - `DATABASE_URL` и блок `DB_*` — параметры подключения к MySQL.
   - `NUXT_SECRET_KEY` — секрет приложения Nuxt.
   - Параметры интеграций (`BITRIX_*`, `DIRECTUS_*`, `NUXT_PUBLIC_*`) настройте в соответствии с вашим окружением.

## 3. Подготовка базы данных

### Вариант A. Использовать Docker (локальная разработка)

```bash
npm run docker:up       # поднимает контейнер с MySQL
npm run db:push         # применяет актуальную схему
npm run db:seed         # заполняет демонстрационными данными (опционально)
```

Команда `npm run setup:dev` объединяет шаги выше (поднятие Docker + схема + сиды).

### Вариант B. Внешняя база данных

1. Создайте схему в вашей БД и укажите правильные креденшалы в `.env`.
2. Выполните:

   ```bash
   npm run db:deploy   # применяет миграции на целевую БД
   npm run db:seed     # (опционально) начальные данные
   ```

## 4. Запуск приложения

### Локальная разработка

```bash
npm run dev
```

Приложение будет доступно по адресу `http://localhost:3000`.

### Продакшен/стейджинг

```bash
npm run build
npm run db:deploy    # убедитесь, что схема актуальна
node .output/server/index.mjs
```

При необходимости настройте менеджер процессов (PM2/systemd) и прокси-сервер (Nginx) для постоянной работы приложения.

## 5. Полезные команды

```bash
npm run docker:logs   # посмотреть логи MySQL
npm run docker:down   # остановить контейнеры
npm run db:studio     # открыть Prisma Studio
npm run lint          # проверить качество кода
npm test              # запустить тесты
```

Следуйте этим шагам для развёртывания и поддержания актуального состояния серверного окружения.
